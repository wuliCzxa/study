MOV A, #00H          ; ʼ
MOV R0, A            ; ʼR0Aԭ洢
MOV R1, A            ; ʼR1Bԭ洢
MOV R2, A            ; ʼR2AĲ洢
MOV R3, A            ; ʼR3BĲ洢

MOV 0D0H, A          ; ʼڴ洢ַ0D0H
MOV 0D1H, A          ; ʼڴ洢ַ0D1H
MOV 0D2H, A          ; ʼڴ洢ַ0D2H
MOV 0E0H, A          ; Aλ洢
MOV 0E1H, A          ; Aλȡ洢
MOV 0E2H, A          ; Bλ洢
MOV 0E3H, A          ; Bλȡ洢
MOV 0E4H, A          ; ӷλ洢
MOV 0E5H, A          ; ӷλȡ洢

INPUT:               ; ԭ
    MOV A, #50H      ; Aԭ(6E,50,94,94,72,94,00)
    MOV 0D0H, A      ; 洢Aַ
    MOV A, #30H      ; Bԭ(0A,3C,F8,88,1E,0A,00)
    MOV 0D1H, A      ; 洢Bַ
    JC INPUT_CHECK

INPUT_CHECK:
    MOV A, 0D0H      ; A
    AND A, #0FFH     ; ȷЧԼ(7λΧ)
    JC INPUT_ERROR   ; ת
    MOV R0, A        ; 洢R0

    MOV A, 0D1H      ; B
    AND A, #0FFH     ; ȷЧԼ(7λΧ)
    JC INPUT_ERROR   ; ת
    MOV R1, A        ; 洢R1

CONVERT_A:
    MOV A, R0        ; Aԭ
    JZ ZERO_A        ; AΪ0ת
    AND A, #80H      ; λ
    JZ POS_A         ; Ϊ
    MOV A, R0
    CPL A            ; Ϊȡ
    ADD A, #81H      ; 1õ
    JMP SAVE_A

POS_A:
    MOV A, R0        ; ֱӽԭ븳ֵΪ
    JMP SAVE_A

ZERO_A:
    MOV A, #00H      ; AΪ0ʱҲ0

SAVE_A:
    MOV R2, A        ; AĲ洢R2

CONVERT_B:
    MOV A, #00H
    ADD A, R1        ; Bԭ
    JZ ZERO_B        ; BΪ0ת
    AND A, #80H      ; λ
    JZ POS_B         ; Ϊ
    MOV A, R1
    CPL A            ; Ϊȡ
    ADD A, #81H      ; 1õ
    JMP SAVE_B

POS_B:
    MOV A, R1        ; ֱӽԭ븳ֵΪ
    JMP SAVE_B

ZERO_B:
    MOV A, #00H      ; BΪ0ʱҲ0

SAVE_B:
    MOV R3, A        ; BĲ洢R3

ADD_OPERATION:
    ; ӷ
    MOV A, R2        ; A
    ADDC A, R3       ; B벢ǽλ
    MOV 0D2H, A      ; ݴ

    ; ȡͼ
    MOV A, R2        ; ȡAλ
    AND A, #80H      ; ȡλ
    MOV 0E0H, A      ; 洢λ
    CPL A            ; ȡ
    MOV 0E1H, A      ; 洢λȡ

    MOV A, R3        ; ȡBλ
    AND A, #80H      ; ȡλ
    MOV 0E2H, A      ; 洢λ
    CPL A            ; ȡ
    MOV 0E3H, A      ; 洢λȡ

    MOV A, 0D2H      ; ȡӷλ
    AND A, #80H      ; ȡλ
    MOV 0E4H, A      ; 洢λ
    CPL A            ; ȡ
    MOV 0E5H, A      ; 洢λȡ

    ; ʽ
    MOV A, 0E0H      ; Aλ
    AND A, 0E2H      ; Bλ
    AND A, 0E5H      ; ӷλȡ
    MOV 0C0H, A      ; ݴм1

    MOV A, 0E1H      ; Aλȡ
    AND A, 0E3H      ; Bλȡ
    AND A, 0E4H      ; ӷλ
    OR A, 0C0H       ; ϲ
    JZ STORE_RESULT  ; Ϊ0

    ; 绹
    MOV A, 0E0H      ; Aλ
    AND A, 0E2H      ; Bλ
    AND A, 0E5H      ; ӷλȡ
    JZ OVERFLOW_UPPER; Ϊ0紦

OVERFLOW_LOWER:
    ; 紦
    MOV A, #0FEH     ; ־
    OUT              ; 
    JMP OVER

OVERFLOW_UPPER:
    ;紦
    MOV A, #0FFH     ; ־
    OUT              ; 
    JMP OVER

STORE_RESULT:
    ; 
    MOV A, 0D2H      ; ȡ
    AND A, #80H      ; λ
    JZ POS_RESULT    ; Ϊ
    MOV A, 0D2H
    SUBC A, #81H      
    CPL A            ; תԭ
    OUT              ; 
    JMP OVER
        
POS_RESULT:
    MOV A, 0D2H      ; ֱӽԭ븳ֵΪ
    OUT
    JMP OVER
    
OVER:
    JMP OVER         ; 
   
INPUT_ERROR:
    ; 봦״̬ 
    MOV A, #0FFH     ; ־
    OUT
    JMP OVER
   
